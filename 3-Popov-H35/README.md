Вариант H35 
Декартово дерево по неявному ключу. 
Сделать функции split merge добавить удалить найти по ключу за логарифм.